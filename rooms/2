from django.shortcuts import render
from django.http import HttpResponseRedirect, HttpResponse
from room.models import Person
from django.views.decorators.csrf import csrf_exempt
import json

@csrf_exempt
def insertPerson(request):
    if request.method == 'POST':
        name = request.POST.get('name')
        roomno = request.POST.get('roomno')
        rollno = request.POST.get('rollno')
        Person(name=name, roomno=roomno, rollno=rollno).save()
        print request.POST.getlist('roomsarray[]')
        # meke n Relationship object 
        return HttpResponseRedirect('/insertPerson/')
    return render(request, 'getPersonDetails.html')

def success(request):
    return HttpResponse("hey")

def getRooms(request):
    rooms = [x.strip() for x in Person.objects.all().values_list('roomno', flat=True)]
    return HttpResponse(json.dumps(rooms))
